---
import { getCollection } from "astro:content";

let posts = await getCollection("blogs", ({ data }: any) => {
	return data.draft !== true;
});

posts.sort(
	(a, b) => b.data.publishedDate.getTime() - a.data.publishedDate.getTime(),
);
---

<div
	id="blogs"
	class="max-w-5xl mx-auto px-5 sm:px-6 lg:px-8 overflow-x-hidden"
>
	<div class="mb-6 flex items-center justify-between">
		<h3 class="text-3xl">Recent Writing</h3>
		{
			posts.length ? (
				<a href="/blogs" class="underline cursor-pointer">
					View All
				</a>
			) : null
		}
	</div>

	{
		posts.length ? (
			<div class="space-y-12">
				{posts.map((post) => {
					const popularTags = post.data.popularTags?.split(",");
					return (
						<article class="flex flex-col md:flex-row items-start md:items-center gap-8 pb-8">
							<div class="flex flex-col justify-between">
								<div class="flex items-center gap-x-4 text-sm">
									<time
										datetime={post.data.publishedDate.toISOString()}
									>
										{new Intl.DateTimeFormat("en-US", {
											weekday: "short",
											month: "short",
											day: "2-digit",
											year: "numeric",
										}).format(post.data.publishedDate)}
									</time>
									{popularTags?.map((tag) => (
										<span class="relative z-10 rounded-full bg-gray-100 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100 dark:bg-gray-800/60 dark:text-gray-300 dark:hover:bg-gray-800">
											{tag}
										</span>
									))}
								</div>
								<h3 class="mt-3 text-lg font-semibold text-gray-900 group-hover:text-gray-600 dark:text-white dark:group-hover:text-gray-300 hover:underline">
									<a href={`/blogs/${post.slug}`}>
										{post.data.title}
									</a>
								</h3>
								<p class="mt-3 text-md text-gray-700 dark:text-gray-400 line-clamp-3 leading-10">
									{post.data.description}
								</p>
							</div>
						</article>
					);
				})}
			</div>
		) : (
			<p class="text-xl">No recent post!</p>
		)
	}

	<div class="space-y-12 hidden">
		<!-- Article 1 -->
		<article
			class="flex flex-col md:flex-row items-start md:items-center gap-8 pb-8"
		>
			<div class="flex flex-col justify-between">
				<div class="flex items-center gap-x-4 text-sm">
					<time
						datetime="2020-03-16"
						class="text-gray-600 dark:text-gray-400"
					>
						Mar 16, 2020
					</time>
					<a
						href="#"
						class="relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100 dark:bg-gray-800/60 dark:text-gray-300 dark:hover:bg-gray-800"
						>Marketing</a
					>
				</div>

				<h3
					class="mt-3 text-lg font-semibold text-gray-900 group-hover:text-gray-600 dark:text-white dark:group-hover:text-gray-300"
				>
					<a href="#">Boost your conversion rate</a>
				</h3>
				<p
					class="mt-3 text-md text-gray-700 dark:text-gray-400 line-clamp-3 leading-10"
				>
					Illo sint voluptas. Error voluptates culpa eligendi. Hic vel
					totam vitae illo. Non aliquid explicabo necessitatibus unde.
					Sed exercitationem placeat consectetur nulla deserunt vel
					iusto corrupti dicta laboris incididunt.
				</p>
			</div>
		</article>

		<!-- Repeat similar articles -->
		<article
			class="flex flex-col md:flex-row items-start md:items-center gap-8 pb-8"
		>
			<div class="flex flex-col justify-between">
				<div class="flex items-center gap-x-4 text-sm">
					<time
						datetime="2020-03-10"
						class="text-gray-600 dark:text-gray-400"
					>
						Mar 10, 2020
					</time>
					<a
						href="#"
						class="relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100 dark:bg-gray-800/60 dark:text-gray-300 dark:hover:bg-gray-800"
						>Sales</a
					>
				</div>
				<h3
					class="mt-3 text-lg font-semibold text-gray-900 group-hover:text-gray-600 dark:text-white dark:group-hover:text-gray-300"
				>
					<a href="#"
						>How to use search engine optimization to drive sales</a
					>
				</h3>
				<p
					class="mt-3 text-md text-gray-700 dark:text-gray-400 line-clamp-3 leading-10"
				>
					Optio sit exercitation et ex ullamco aliquid explicabo.
					Dolore do ut officia anim non ad eu. Magna laboris
					incididunt commodo elit ipsum.
				</p>
			</div>
		</article>

		<article
			class="flex flex-col md:flex-row items-start md:items-center gap-8 pb-8"
		>
			<div class="flex flex-col justify-between">
				<div class="flex items-center gap-x-4 text-sm">
					<time
						datetime="2020-03-10"
						class="text-gray-600 dark:text-gray-400"
					>
						Mar 10, 2020
					</time>
					<a
						href="#"
						class="relative z-10 rounded-full bg-gray-50 px-3 py-1.5 font-medium text-gray-600 hover:bg-gray-100 dark:bg-gray-800/60 dark:text-gray-300 dark:hover:bg-gray-800"
						>Sales</a
					>
				</div>
				<h3
					class="mt-3 text-lg font-semibold text-gray-900 group-hover:text-gray-600 dark:text-white dark:group-hover:text-gray-300"
				>
					<a href="#">Improve your customer experience</a>
				</h3>
				<p
					class="mt-3 text-md text-gray-700 dark:text-gray-400 line-clamp-3 leading-10"
				>
					Dolore commodo in nulla do nulla esse consectetur.
					Adipisicing voluptate velit sint adipisicing ex duis elit
					deserunt sint ipsum. Culpa in exercitation magna adipisicing
					id reprehenderit consectetur culpa eu cillum.
				</p>
			</div>
		</article>
	</div>
</div>
